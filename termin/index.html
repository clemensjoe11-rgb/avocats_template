<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Termin buchen</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{--brand:#2ec4b6;--brand-600:#26a79b;--bg:#0b0c0f;--card:#15181c;--text:#e8edf2;--muted:#9aa3ad;--danger:#ff5c5c}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 Inter,system-ui,Segoe UI,Arial;display:grid;place-items:start center;min-height:100svh}
.wrap{width:min(1100px,100%);padding:24px}
.header{display:grid;grid-template-columns:1fr auto;align-items:center;gap:12px;margin-bottom:12px}
.nav-core{place-self:center;display:flex;align-items:center;gap:12px}
.btn{border-radius:12px;padding:8px 12px;cursor:pointer;font-weight:600;border:1px solid rgba(255,255,255,.18);background:transparent;color:var(--text)}
.btn.primary{background:var(--brand);border:none;color:#0b0c0f}
.btn.primary:hover{background:var(--brand-600)}
.card{background:var(--card);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px}
.clock{color:var(--muted);text-align:center;margin-bottom:12px}
.grid{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:14px}
.day{display:flex;flex-direction:column;gap:10px;min-width:140px}
.head{display:grid;align-content:center;justify-items:center;gap:4px;height:64px;text-align:center}
.dnum{font-weight:600}
.dow{color:var(--muted);font-size:12px}
.slots{display:grid;grid-auto-rows:44px;gap:10px}
.slot{height:44px;display:grid;place-items:center;border-radius:14px;background:var(--brand);color:#0b0c0f;font-weight:600;cursor:pointer}
.slot:hover{background:var(--brand-600)}
.slot.selected{outline:2px solid #fff}
.hint{color:var(--muted);font-size:13px;margin-top:6px}
.ok{color:#3ddc97}.err{color:#ff6b6b}
.confirm-bar{position:fixed;left:0;right:0;bottom:0;z-index:50;display:none;background:rgba(21,24,28,.92);border-top:1px solid rgba(255,255,255,.08);backdrop-filter:blur(6px);padding:12px 16px}
.confirm-bar.show{display:block}
.confirm-bar .btn{width:100%;height:48px;font-weight:700;border-radius:12px}
</style>
</head>
<body>
<div class="wrap">
  <div class="header">
    <div class="nav-core">
      <a class="btn" href="../index.html">← Zurück</a>
    </div>
  </div>

  <div class="card">
    <div id="clock" class="clock">—:—</div>
    <div class="grid" id="grid"></div>

    <div class="form-block" id="formBlock" style="display:none;margin-top:16px">
      <form id="form" class="form" novalidate style="display:grid;grid-template-columns:repeat(2,minmax(260px,1fr));gap:14px">
        <div><label for="first" style="display:block;font-size:12px;color:#9aa3ad;margin-bottom:6px">Vorname</label><input id="first" required style="width:100%;padding:11px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#0f1215;color:#e8edf2"></div>
        <div><label for="last" style="display:block;font-size:12px;color:#9aa3ad;margin-bottom:6px">Nachname</label><input id="last" required style="width:100%;padding:11px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#0f1215;color:#e8edf2"></div>
        <div class="full" style="grid-column:1/-1"><label for="email" style="display:block;font-size:12px;color:#9aa3ad;margin-bottom:6px">E‑Mail</label><input id="email" type="email" required style="width:100%;padding:11px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.14);background:#0f1215;color:#e8edf2"></div>
        <div class="full" style="grid-column:1/-1"><label style="font-size:12px;color:#9aa3ad"><input id="terms" type="checkbox" required> Ich akzeptiere die Bedingungen.</label></div>
        <div id="msg" class="full hint" style="grid-column:1/-1"></div>
      </form>
    </div>
  </div>
</div>

<div id="confirmBar" class="confirm-bar">
  <button id="confirmBtn" class="btn primary" type="button">Weiter</button>
</div>

<script>
(()=>{
const SLOT_MIN=30, START=8, END=17, LOCALE="de-DE";
let selectedTs=null;

const grid=document.getElementById("grid");
const clock=document.getElementById("clock");
const formBlock=document.getElementById("formBlock");
const form=document.getElementById("form");
const msg=document.getElementById("msg");
const confirmBar=document.getElementById("confirmBar");
const confirmBtn=document.getElementById("confirmBtn");

function tick(){clock.textContent=new Date().toLocaleString(LOCALE,{weekday:'short',day:'2-digit',month:'2-digit',hour:'2-digit',minute:'2-digit'})}
tick(); setInterval(tick,30000);

function buildWeek(){
  const out=[];
  const startOfWeek=(()=>{const d=new Date();const w=(d.getDay()+6)%7;d.setDate(d.getDate()-w);d.setHours(0,0,0,0);return d;})();
  for(let i=0;i<7;i++){
    const day=new Date(startOfWeek); day.setDate(day.getDate()+i);
    const slots=[];
    for(let h=START;h<END;h++){ for(let m=0;m<60;m+=SLOT_MIN){
      const s=new Date(day); s.setHours(h,m,0,0);
      slots.push({ts:s.getTime(), label:s.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})});
    }}
    out.push({day, slots});
  }
  return out;
}

function render(){
  const week=buildWeek();
  grid.innerHTML=week.map(col=>`
    <div class="day">
      <div class="head">
        <div class="dnum">${col.day.toLocaleDateString(LOCALE,{day:'2-digit'})}</div>
        <div class="dow" style="color:#9aa3ad;font-size:12px">${col.day.toLocaleDateString(LOCALE,{weekday:'short'})}</div>
      </div>
      <div class="slots">
        ${col.slots.map(s=>`<button class="slot" data-ts="${s.ts}">${s.label}</button>`).join('')}
      </div>
    </div>`).join('');

  grid.querySelectorAll('.slot').forEach(b=>b.addEventListener('click',()=>{
    grid.querySelectorAll('.slot.selected').forEach(x=>x.classList.remove('selected'));
    b.classList.add('selected'); selectedTs=Number(b.dataset.ts);
    msg.innerHTML = `Ausgewählt: <span class="ok">${new Date(selectedTs).toLocaleString(LOCALE,{weekday:'short',day:'2-digit',month:'2-digit',hour:'2-digit',minute:'2-digit'})}</span>`;
    confirmBar.classList.add('show');
  }));
}

confirmBtn.addEventListener('click', ()=>{
  if(confirmBtn.textContent==='Weiter'){
    formBlock.style.display='block';
    confirmBtn.textContent='Termin bestätigen';
    formBlock.scrollIntoView({behavior:'smooth'});
  } else {
    form.requestSubmit();
  }
});

form.addEventListener('submit', (e)=>{
  e.preventDefault();
  const first=document.getElementById('first').value.trim();
  const last=document.getElementById('last').value.trim();
  const email=document.getElementById('email').value.trim();
  const terms=document.getElementById('terms').checked;
  if(!selectedTs){msg.innerHTML='<span class="err">Bitte erst einen Termin wählen.</span>';return;}
  if(!first||!last){msg.innerHTML='<span class="err">Vor- und Nachname angeben.</span>';return;}
  if(!/^\S+@\S+\.\S+$/.test(email)){msg.innerHTML='<span class="err">E‑Mail prüfen.</span>';return;}
  if(!terms){msg.innerHTML='<span class="err">Bitte Bedingungen akzeptieren.</span>';return;}
  msg.innerHTML='<span class="ok">Termin vorgemerkt (Demo). Dieses Frontend speichert lokal.</span>';
  confirmBtn.disabled=true;
});

render();
})();
</script>
</body>
</html>
